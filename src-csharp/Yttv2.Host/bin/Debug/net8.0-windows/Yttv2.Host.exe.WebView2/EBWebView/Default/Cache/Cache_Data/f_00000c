import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/components/HistoryPage.jsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=cd56faf3"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = RefreshRuntime.getRefreshReg("C:/Projects/yttv2/src/components/HistoryPage.jsx");
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
var _s = $RefreshSig$();
import __vite__cjsImport3_react from "/node_modules/.vite/deps/react.js?v=cd56faf3"; const React = __vite__cjsImport3_react.__esModule ? __vite__cjsImport3_react.default : __vite__cjsImport3_react; const useState = __vite__cjsImport3_react["useState"]; const useEffect = __vite__cjsImport3_react["useEffect"];
import { Clock } from "/node_modules/.vite/deps/lucide-react.js?v=cd56faf3";
import { getWatchHistory } from "/src/api/playlistApi.js";
import { getThumbnailUrl } from "/src/utils/youtubeUtils.js";
import { useLayoutStore } from "/src/store/layoutStore.js";
import Card from "/src/components/Card.jsx";
import CardThumbnail from "/src/components/CardThumbnail.jsx";
import CardContent from "/src/components/CardContent.jsx";
import PageBanner from "/src/components/PageBanner.jsx";
const HistoryPage = ({ onVideoSelect, onSecondPlayerSelect }) => {
  _s();
  const [history, setHistory] = useState([]);
  const [loading, setLoading] = useState(true);
  const { inspectMode } = useLayoutStore();
  const getInspectTitle = (label) => inspectMode ? label : void 0;
  useEffect(() => {
    loadHistory();
  }, []);
  const loadHistory = async () => {
    try {
      setLoading(true);
      const historyData = await getWatchHistory(100);
      setHistory(historyData || []);
    } catch (error) {
      console.error("Failed to load watch history:", error);
      alert(`Failed to load watch history: ${error.message || "Unknown error"}`);
    } finally {
      setLoading(false);
    }
  };
  const handleVideoClick = (video) => {
    if (onVideoSelect) {
      onVideoSelect(video.video_url);
    }
  };
  const formatDate = (dateString) => {
    try {
      const date = new Date(dateString);
      const now = /* @__PURE__ */ new Date();
      const diffMs = now - date;
      const diffMins = Math.floor(diffMs / 6e4);
      const diffHours = Math.floor(diffMs / 36e5);
      const diffDays = Math.floor(diffMs / 864e5);
      if (diffMins < 1) return "Just now";
      if (diffMins < 60) return `${diffMins} minute${diffMins !== 1 ? "s" : ""} ago`;
      if (diffHours < 24) return `${diffHours} hour${diffHours !== 1 ? "s" : ""} ago`;
      if (diffDays < 7) return `${diffDays} day${diffDays !== 1 ? "s" : ""} ago`;
      return date.toLocaleDateString("en-US", { month: "short", day: "numeric", year: date.getFullYear() !== now.getFullYear() ? "numeric" : void 0 });
    } catch {
      return dateString;
    }
  };
  if (loading) {
    return /* @__PURE__ */ jsxDEV("div", { className: "flex items-center justify-center w-full h-full", children: /* @__PURE__ */ jsxDEV("p", { className: "text-slate-400", children: "Loading history..." }, void 0, false, {
      fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
      lineNumber: 85,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
      lineNumber: 84,
      columnNumber: 7
    }, this);
  }
  if (history.length === 0) {
    return /* @__PURE__ */ jsxDEV("div", { className: "flex items-center justify-center w-full h-full", children: /* @__PURE__ */ jsxDEV("p", { className: "text-slate-400", children: "No watch history yet" }, void 0, false, {
      fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
      lineNumber: 93,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
      lineNumber: 92,
      columnNumber: 7
    }, this);
  }
  return /* @__PURE__ */ jsxDEV("div", { className: "w-full h-full flex flex-col bg-transparent", children: /* @__PURE__ */ jsxDEV("div", { className: "flex-1 overflow-y-auto p-6", children: [
    /* @__PURE__ */ jsxDEV(
      PageBanner,
      {
        title: "History",
        description: "Your recently watched videos.",
        color: null,
        isEditable: false
      },
      void 0,
      false,
      {
        fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
        lineNumber: 101,
        columnNumber: 9
      },
      this
    ),
    /* @__PURE__ */ jsxDEV("div", { className: "flex flex-col space-y-3 max-w-5xl mx-auto", children: history.map((item) => {
      const thumbnailUrl = item.thumbnail_url || getThumbnailUrl(item.video_id, "medium");
      return /* @__PURE__ */ jsxDEV(
        Card,
        {
          onClick: () => handleVideoClick(item),
          className: "flex flex-row gap-5 p-3 bg-slate-800/40 hover:bg-slate-800/80 rounded-xl transition-all group w-full border border-transparent hover:border-slate-700/50",
          title: getInspectTitle(`History video: ${item.title || "Untitled"}`),
          variant: "minimal",
          children: [
            /* @__PURE__ */ jsxDEV("div", { className: "w-64 shrink-0 aspect-video rounded-lg overflow-hidden relative shadow-md group-hover:shadow-xl transition-all", children: /* @__PURE__ */ jsxDEV(
              CardThumbnail,
              {
                src: thumbnailUrl,
                alt: item.title || "Video thumbnail",
                overlay: /* @__PURE__ */ jsxDEV("div", { className: "opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-3 pointer-events-auto bg-black/40 backdrop-blur-[2px] absolute inset-0 justify-center", children: /* @__PURE__ */ jsxDEV(
                  "button",
                  {
                    onClick: (e) => {
                      e.stopPropagation();
                      handleVideoClick(item);
                    },
                    className: "bg-sky-500 hover:bg-sky-400 rounded-full p-3 transition-all active:scale-90 shadow-lg hover:scale-110",
                    style: { color: "#052F4A" },
                    title: getInspectTitle("Play video") || "Play video",
                    children: /* @__PURE__ */ jsxDEV("svg", { className: "w-8 h-8", fill: "currentColor", viewBox: "0 0 20 20", children: /* @__PURE__ */ jsxDEV("path", { d: "M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z" }, void 0, false, {
                      fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
                      lineNumber: 136,
                      columnNumber: 29
                    }, this) }, void 0, false, {
                      fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
                      lineNumber: 135,
                      columnNumber: 27
                    }, this)
                  },
                  void 0,
                  false,
                  {
                    fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
                    lineNumber: 126,
                    columnNumber: 25
                  },
                  this
                ) }, void 0, false, {
                  fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
                  lineNumber: 125,
                  columnNumber: 21
                }, this)
              },
              void 0,
              false,
              {
                fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
                lineNumber: 121,
                columnNumber: 19
              },
              this
            ) }, void 0, false, {
              fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
              lineNumber: 120,
              columnNumber: 17
            }, this),
            /* @__PURE__ */ jsxDEV("div", { className: "flex flex-col justify-center flex-1 min-w-0 py-2", children: [
              /* @__PURE__ */ jsxDEV(
                "h3",
                {
                  className: "text-lg font-bold mb-2 line-clamp-2 leading-tight transition-colors",
                  style: { color: "#052F4A" },
                  onMouseEnter: (e) => e.currentTarget.style.color = "#38bdf8",
                  onMouseLeave: (e) => e.currentTarget.style.color = "#052F4A",
                  children: item.title || "Untitled Video"
                },
                void 0,
                false,
                {
                  fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
                  lineNumber: 146,
                  columnNumber: 19
                },
                this
              ),
              /* @__PURE__ */ jsxDEV("div", { className: "flex items-center text-sm text-slate-400 font-medium", children: /* @__PURE__ */ jsxDEV("span", { className: "flex items-center gap-1.5 bg-slate-900/50 px-2 py-1 rounded-md border border-slate-700/50", children: [
                /* @__PURE__ */ jsxDEV(Clock, { size: 14, className: "text-sky-500/80" }, void 0, false, {
                  fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
                  lineNumber: 154,
                  columnNumber: 23
                }, this),
                formatDate(item.watched_at)
              ] }, void 0, true, {
                fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
                lineNumber: 153,
                columnNumber: 21
              }, this) }, void 0, false, {
                fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
                lineNumber: 152,
                columnNumber: 19
              }, this)
            ] }, void 0, true, {
              fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
              lineNumber: 145,
              columnNumber: 17
            }, this)
          ]
        },
        item.id,
        true,
        {
          fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
          lineNumber: 112,
          columnNumber: 15
        },
        this
      );
    }) }, void 0, false, {
      fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
      lineNumber: 107,
      columnNumber: 9
    }, this)
  ] }, void 0, true, {
    fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
    lineNumber: 100,
    columnNumber: 7
  }, this) }, void 0, false, {
    fileName: "C:/Projects/yttv2/src/components/HistoryPage.jsx",
    lineNumber: 99,
    columnNumber: 5
  }, this);
};
_s(HistoryPage, "KMmUdOEYouyKHYo4Zzumafw0Po8=", false, function() {
  return [useLayoutStore];
});
_c = HistoryPage;
export default HistoryPage;
var _c;
$RefreshReg$(_c, "HistoryPage");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}
if (import.meta.hot && !inWebWorker) {
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/Projects/yttv2/src/components/HistoryPage.jsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("C:/Projects/yttv2/src/components/HistoryPage.jsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,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aEVGO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0FpRUE7QUFFSjtBQUFFL0MsR0F4SUlILGFBQVc7QUFBQSxVQUdTTCxjQUFjO0FBQUE7QUFBQXdELEtBSGxDbkQ7QUEwSU4sZUFBZUE7QUFBWSxJQUFBbUQ7QUFBQUMsYUFBQUQsSUFBQSIsIm5hbWVzIjpbIlJlYWN0IiwidXNlU3RhdGUiLCJ1c2VFZmZlY3QiLCJDbG9jayIsImdldFdhdGNoSGlzdG9yeSIsImdldFRodW1ibmFpbFVybCIsInVzZUxheW91dFN0b3JlIiwiQ2FyZCIsIkNhcmRUaHVtYm5haWwiLCJDYXJkQ29udGVudCIsIlBhZ2VCYW5uZXIiLCJIaXN0b3J5UGFnZSIsIm9uVmlkZW9TZWxlY3QiLCJvblNlY29uZFBsYXllclNlbGVjdCIsIl9zIiwiaGlzdG9yeSIsInNldEhpc3RvcnkiLCJsb2FkaW5nIiwic2V0TG9hZGluZyIsImluc3BlY3RNb2RlIiwiZ2V0SW5zcGVjdFRpdGxlIiwibGFiZWwiLCJ1bmRlZmluZWQiLCJsb2FkSGlzdG9yeSIsImhpc3RvcnlEYXRhIiwiZXJyb3IiLCJjb25zb2xlIiwiYWxlcnQiLCJtZXNzYWdlIiwiaGFuZGxlVmlkZW9DbGljayIsInZpZGVvIiwidmlkZW9fdXJsIiwiZm9ybWF0RGF0ZSIsImRhdGVTdHJpbmciLCJkYXRlIiwiRGF0ZSIsIm5vdyIsImRpZmZNcyIsImRpZmZNaW5zIiwiTWF0aCIsImZsb29yIiwiZGlmZkhvdXJzIiwiZGlmZkRheXMiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJtb250aCIsImRheSIsInllYXIiLCJnZXRGdWxsWWVhciIsImxlbmd0aCIsIm1hcCIsIml0ZW0iLCJ0aHVtYm5haWxVcmwiLCJ0aHVtYm5haWxfdXJsIiwidmlkZW9faWQiLCJ0aXRsZSIsImUiLCJzdG9wUHJvcGFnYXRpb24iLCJjb2xvciIsImN1cnJlbnRUYXJnZXQiLCJzdHlsZSIsIndhdGNoZWRfYXQiLCJpZCIsIl9jIiwiJFJlZnJlc2hSZWckIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbIkhpc3RvcnlQYWdlLmpzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgQ2xvY2sgfSBmcm9tICdsdWNpZGUtcmVhY3QnO1xyXG5pbXBvcnQgeyBnZXRXYXRjaEhpc3RvcnkgfSBmcm9tICcuLi9hcGkvcGxheWxpc3RBcGknO1xyXG5pbXBvcnQgeyBnZXRUaHVtYm5haWxVcmwgfSBmcm9tICcuLi91dGlscy95b3V0dWJlVXRpbHMnO1xyXG5pbXBvcnQgeyB1c2VMYXlvdXRTdG9yZSB9IGZyb20gJy4uL3N0b3JlL2xheW91dFN0b3JlJztcclxuaW1wb3J0IENhcmQgZnJvbSAnLi9DYXJkJztcclxuaW1wb3J0IENhcmRUaHVtYm5haWwgZnJvbSAnLi9DYXJkVGh1bWJuYWlsJztcclxuaW1wb3J0IENhcmRDb250ZW50IGZyb20gJy4vQ2FyZENvbnRlbnQnO1xyXG5pbXBvcnQgUGFnZUJhbm5lciBmcm9tICcuL1BhZ2VCYW5uZXInO1xyXG5cclxuY29uc3QgSGlzdG9yeVBhZ2UgPSAoeyBvblZpZGVvU2VsZWN0LCBvblNlY29uZFBsYXllclNlbGVjdCB9KSA9PiB7XHJcbiAgY29uc3QgW2hpc3RvcnksIHNldEhpc3RvcnldID0gdXNlU3RhdGUoW10pO1xyXG4gIGNvbnN0IFtsb2FkaW5nLCBzZXRMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xyXG4gIGNvbnN0IHsgaW5zcGVjdE1vZGUgfSA9IHVzZUxheW91dFN0b3JlKCk7XHJcblxyXG4gIC8vIEhlbHBlciB0byBnZXQgaW5zcGVjdCBsYWJlbFxyXG4gIGNvbnN0IGdldEluc3BlY3RUaXRsZSA9IChsYWJlbCkgPT4gaW5zcGVjdE1vZGUgPyBsYWJlbCA6IHVuZGVmaW5lZDtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGxvYWRIaXN0b3J5KCk7XHJcbiAgfSwgW10pO1xyXG5cclxuICBjb25zdCBsb2FkSGlzdG9yeSA9IGFzeW5jICgpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XHJcbiAgICAgIGNvbnN0IGhpc3RvcnlEYXRhID0gYXdhaXQgZ2V0V2F0Y2hIaXN0b3J5KDEwMCk7XHJcbiAgICAgIHNldEhpc3RvcnkoaGlzdG9yeURhdGEgfHwgW10pO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgd2F0Y2ggaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgIGFsZXJ0KGBGYWlsZWQgdG8gbG9hZCB3YXRjaCBoaXN0b3J5OiAke2Vycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlVmlkZW9DbGljayA9ICh2aWRlbykgPT4ge1xyXG4gICAgaWYgKG9uVmlkZW9TZWxlY3QpIHtcclxuICAgICAgb25WaWRlb1NlbGVjdCh2aWRlby52aWRlb191cmwpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGZvcm1hdERhdGUgPSAoZGF0ZVN0cmluZykgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGRhdGVTdHJpbmcpO1xyXG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICBjb25zdCBkaWZmTXMgPSBub3cgLSBkYXRlO1xyXG4gICAgICBjb25zdCBkaWZmTWlucyA9IE1hdGguZmxvb3IoZGlmZk1zIC8gNjAwMDApO1xyXG4gICAgICBjb25zdCBkaWZmSG91cnMgPSBNYXRoLmZsb29yKGRpZmZNcyAvIDM2MDAwMDApO1xyXG4gICAgICBjb25zdCBkaWZmRGF5cyA9IE1hdGguZmxvb3IoZGlmZk1zIC8gODY0MDAwMDApO1xyXG5cclxuICAgICAgaWYgKGRpZmZNaW5zIDwgMSkgcmV0dXJuICdKdXN0IG5vdyc7XHJcbiAgICAgIGlmIChkaWZmTWlucyA8IDYwKSByZXR1cm4gYCR7ZGlmZk1pbnN9IG1pbnV0ZSR7ZGlmZk1pbnMgIT09IDEgPyAncycgOiAnJ30gYWdvYDtcclxuICAgICAgaWYgKGRpZmZIb3VycyA8IDI0KSByZXR1cm4gYCR7ZGlmZkhvdXJzfSBob3VyJHtkaWZmSG91cnMgIT09IDEgPyAncycgOiAnJ30gYWdvYDtcclxuICAgICAgaWYgKGRpZmZEYXlzIDwgNykgcmV0dXJuIGAke2RpZmZEYXlzfSBkYXkke2RpZmZEYXlzICE9PSAxID8gJ3MnIDogJyd9IGFnb2A7XHJcblxyXG4gICAgICAvLyBGb3Igb2xkZXIgZGF0ZXMsIHNob3cgYWN0dWFsIGRhdGVcclxuICAgICAgcmV0dXJuIGRhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCdlbi1VUycsIHsgbW9udGg6ICdzaG9ydCcsIGRheTogJ251bWVyaWMnLCB5ZWFyOiBkYXRlLmdldEZ1bGxZZWFyKCkgIT09IG5vdy5nZXRGdWxsWWVhcigpID8gJ251bWVyaWMnIDogdW5kZWZpbmVkIH0pO1xyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIHJldHVybiBkYXRlU3RyaW5nO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGlmIChsb2FkaW5nKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHctZnVsbCBoLWZ1bGxcIj5cclxuICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNsYXRlLTQwMFwiPkxvYWRpbmcgaGlzdG9yeS4uLjwvcD5cclxuICAgICAgPC9kaXY+XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgaWYgKGhpc3RvcnkubGVuZ3RoID09PSAwKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHctZnVsbCBoLWZ1bGxcIj5cclxuICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNsYXRlLTQwMFwiPk5vIHdhdGNoIGhpc3RvcnkgeWV0PC9wPlxyXG4gICAgICA8L2Rpdj5cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPGRpdiBjbGFzc05hbWU9XCJ3LWZ1bGwgaC1mdWxsIGZsZXggZmxleC1jb2wgYmctdHJhbnNwYXJlbnRcIj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgb3ZlcmZsb3cteS1hdXRvIHAtNlwiPlxyXG4gICAgICAgIDxQYWdlQmFubmVyXHJcbiAgICAgICAgICB0aXRsZT1cIkhpc3RvcnlcIlxyXG4gICAgICAgICAgZGVzY3JpcHRpb249XCJZb3VyIHJlY2VudGx5IHdhdGNoZWQgdmlkZW9zLlwiXHJcbiAgICAgICAgICBjb2xvcj17bnVsbH1cclxuICAgICAgICAgIGlzRWRpdGFibGU9e2ZhbHNlfVxyXG4gICAgICAgIC8+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtY29sIHNwYWNlLXktMyBtYXgtdy01eGwgbXgtYXV0b1wiPlxyXG4gICAgICAgICAge2hpc3RvcnkubWFwKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRodW1ibmFpbFVybCA9IGl0ZW0udGh1bWJuYWlsX3VybCB8fCBnZXRUaHVtYm5haWxVcmwoaXRlbS52aWRlb19pZCwgJ21lZGl1bScpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICA8Q2FyZFxyXG4gICAgICAgICAgICAgICAga2V5PXtpdGVtLmlkfVxyXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlVmlkZW9DbGljayhpdGVtKX1cclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsZXggZmxleC1yb3cgZ2FwLTUgcC0zIGJnLXNsYXRlLTgwMC80MCBob3ZlcjpiZy1zbGF0ZS04MDAvODAgcm91bmRlZC14bCB0cmFuc2l0aW9uLWFsbCBncm91cCB3LWZ1bGwgYm9yZGVyIGJvcmRlci10cmFuc3BhcmVudCBob3Zlcjpib3JkZXItc2xhdGUtNzAwLzUwXCJcclxuICAgICAgICAgICAgICAgIHRpdGxlPXtnZXRJbnNwZWN0VGl0bGUoYEhpc3RvcnkgdmlkZW86ICR7aXRlbS50aXRsZSB8fCAnVW50aXRsZWQnfWApfVxyXG4gICAgICAgICAgICAgICAgdmFyaWFudD1cIm1pbmltYWxcIlxyXG4gICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIHsvKiBMZWZ0OiBUaHVtYm5haWwgKi99XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctNjQgc2hyaW5rLTAgYXNwZWN0LXZpZGVvIHJvdW5kZWQtbGcgb3ZlcmZsb3ctaGlkZGVuIHJlbGF0aXZlIHNoYWRvdy1tZCBncm91cC1ob3ZlcjpzaGFkb3cteGwgdHJhbnNpdGlvbi1hbGxcIj5cclxuICAgICAgICAgICAgICAgICAgPENhcmRUaHVtYm5haWxcclxuICAgICAgICAgICAgICAgICAgICBzcmM9e3RodW1ibmFpbFVybH1cclxuICAgICAgICAgICAgICAgICAgICBhbHQ9e2l0ZW0udGl0bGUgfHwgJ1ZpZGVvIHRodW1ibmFpbCd9XHJcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmxheT17XHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wYWNpdHktMCBncm91cC1ob3ZlcjpvcGFjaXR5LTEwMCB0cmFuc2l0aW9uLW9wYWNpdHkgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTMgcG9pbnRlci1ldmVudHMtYXV0byBiZy1ibGFjay80MCBiYWNrZHJvcC1ibHVyLVsycHhdIGFic29sdXRlIGluc2V0LTAganVzdGlmeS1jZW50ZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlVmlkZW9DbGljayhpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImJnLXNreS01MDAgaG92ZXI6Ymctc2t5LTQwMCByb3VuZGVkLWZ1bGwgcC0zIHRyYW5zaXRpb24tYWxsIGFjdGl2ZTpzY2FsZS05MCBzaGFkb3ctbGcgaG92ZXI6c2NhbGUtMTEwXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBjb2xvcjogJyMwNTJGNEEnIH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2dldEluc3BlY3RUaXRsZSgnUGxheSB2aWRlbycpIHx8ICdQbGF5IHZpZGVvJ31cclxuICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgY2xhc3NOYW1lPVwidy04IGgtOFwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIiB2aWV3Qm94PVwiMCAwIDIwIDIwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPVwiTTYuMyAyLjg0MUExLjUgMS41IDAgMDA0IDQuMTFWMTUuODlhMS41IDEuNSAwIDAwMi4zIDEuMjY5bDkuMzQ0LTUuODlhMS41IDEuNSAwIDAwMC0yLjUzOEw2LjMgMi44NHpcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgICAgIHsvKiBSaWdodDogSW5mbyAqL31cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LWNvbCBqdXN0aWZ5LWNlbnRlciBmbGV4LTEgbWluLXctMCBweS0yXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJ0ZXh0LWxnIGZvbnQtYm9sZCBtYi0yIGxpbmUtY2xhbXAtMiBsZWFkaW5nLXRpZ2h0IHRyYW5zaXRpb24tY29sb3JzXCJcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBjb2xvcjogJyMwNTJGNEEnIH19XHJcbiAgICAgICAgICAgICAgICAgICAgb25Nb3VzZUVudGVyPXsoZSkgPT4gZS5jdXJyZW50VGFyZ2V0LnN0eWxlLmNvbG9yID0gJyMzOGJkZjgnfVxyXG4gICAgICAgICAgICAgICAgICAgIG9uTW91c2VMZWF2ZT17KGUpID0+IGUuY3VycmVudFRhcmdldC5zdHlsZS5jb2xvciA9ICcjMDUyRjRBJ30+XHJcbiAgICAgICAgICAgICAgICAgICAge2l0ZW0udGl0bGUgfHwgJ1VudGl0bGVkIFZpZGVvJ31cclxuICAgICAgICAgICAgICAgICAgPC9oMz5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciB0ZXh0LXNtIHRleHQtc2xhdGUtNDAwIGZvbnQtbWVkaXVtXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEuNSBiZy1zbGF0ZS05MDAvNTAgcHgtMiBweS0xIHJvdW5kZWQtbWQgYm9yZGVyIGJvcmRlci1zbGF0ZS03MDAvNTBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxDbG9jayBzaXplPXsxNH0gY2xhc3NOYW1lPVwidGV4dC1za3ktNTAwLzgwXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgIHtmb3JtYXREYXRlKGl0ZW0ud2F0Y2hlZF9hdCl9XHJcbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgIDwvQ2FyZD5cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH0pfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gICk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBIaXN0b3J5UGFnZTtcclxuXHJcbiJdLCJmaWxlIjoiQzovUHJvamVjdHMveXR0djIvc3JjL2NvbXBvbmVudHMvSGlzdG9yeVBhZ2UuanN4In0=